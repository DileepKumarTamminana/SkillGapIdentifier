import boto3
from decimal import Decimal

dynamodb = boto3.resource("dynamodb")
table = dynamodb.Table("SkillGapHistory")

def lambda_handler(event, context):
    response = table.scan()
    for item in response["Items"]:
        if "matchPercent" not in item or item["matchPercent"] is None:
            item["matchPercent"] = Decimal("0")
            table.put_item(Item=item)
    return "Fixed"
