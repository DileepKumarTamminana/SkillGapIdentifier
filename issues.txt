import boto3
import json

dynamodb = boto3.resource("dynamodb")
table = dynamodb.Table("SkillGapHistory")

def lambda_handler(event, context):
    resp = table.query(
        IndexName="skillgapIndex",
        KeyConditionExpression=boto3.dynamodb.conditions.Key("employeeId").eq("E001")
    )

    # return EVERYTHING we see for E001's history
    return {
        "statusCode": 200,
        "body": json.dumps(resp["Items"], indent=2, default=str)
    }
